(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{398:function(t,e,r){"use strict";r.r(e);r(63),r(19);var n=r(2),o={middleware:"auth",components:{CardLayout:r(113).a},data:function(){return{user:{},claimable:!0}},computed:{userHideouts:function(){return this.user.hideouts?this.user.hideouts:[]}},created:function(){var t=this;return Object(n.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getUserHideouts();case 2:case"end":return e.stop()}}),e)})))()},methods:{getImage:function(t){return/.jpg|.png|jpeg/gi.test(t.hideoutScreenshot)?t.hideoutScreenshot:this.$store.getters.getHideout(t.hideoutType).Icon},deleteHideout:function(t){var e=this;return Object(n.a)(regeneratorRuntime.mark((function r(){var n;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,e.$axios.$get("/api/hideouts?hideoutId=".concat(t));case 3:return(n=r.sent)[0].isDeleted=!0,r.next=7,e.$axios.put("/api/hideouts/".concat(n[0].id),n[0]);case 7:return r.next=9,e.$store.dispatch("auth/updateUserHideouts");case 9:return r.next=11,e.getUserHideouts();case 11:r.next=16;break;case 13:r.prev=13,r.t0=r.catch(0),console.log(r.t0);case 16:case"end":return r.stop()}}),r,null,[[0,13]])})))()},getHideout:function(t){return this.$store.getters.getHideout(t).Name},getUserHideouts:function(){var t=this;return Object(n.a)(regeneratorRuntime.mark((function e(){var r,n,data;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r="",t.$store.state.auth.user&&(r='\n                query{\n                    user(id:"'.concat(t.$store.state.auth.user._id,'"){\n                            username\n                            confirmed\n                            hideouts(where:{\n                                isDeleted_ne:true\n                            }){\n                                hideoutId\n                                nameDescription\n                                hideoutType\n                                views\n                                downloads\n                                comments{\n                                    _id\n                                }\n                                hideoutDateSubmit\n                                hideoutMasters\n                                hideoutScreenshot\n                                votes{\n                                    score\n                                }\n                            }\n                            }\n                        }\n                ')),e.prev=2,e.next=5,t.$axios.$post("/api/graphql",{query:r});case 5:n=e.sent,data=n.data,t.user=data.user,e.next=13;break;case 10:e.prev=10,e.t0=e.catch(2),console.log(e.t0);case 13:case"end":return e.stop()}}),e,null,[[2,10]])})))()},claimEmailHideouts:function(){var t=this;return Object(n.a)(regeneratorRuntime.mark((function e(){var r,n,data,o,d;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r='\n                        query{\n                            hideouts(where:{\n                                authorEmail:"'.concat(t.$store.state.auth.user.email,'",\n                                isDeleted_ne:true\n                            }){\n                                _id\n                            }\n                            }\n                        '),e.next=4,t.$axios.$post("/api/graphql",{query:r});case 4:if(n=e.sent,data=n.data,o="",!(data.hideouts.length>0)){e.next=15;break}return data.hideouts.forEach((function(t){o+=', "'.concat(t._id,'"')})),d="\n                                mutation{\n                                    updateHideout(input:{\n                                        where:{\n                                            id:".concat(o.replace(', "','"'),'\n                                        },\n                                        data:{\n                                            user:"').concat(t.$store.state.auth.user._id,'"\n                                        }\n                                    }){\n                                        hideout{\n                                            user{\n                                                username,\n                                                email\n                                            }\n                                        }\n                                    }\n                                }\n                    '),e.next=12,t.$axios.post("/api/graphql",{query:d});case 12:t.$store.dispatch("auth/updateUserHideouts"),e.next=16;break;case 15:t.claimable=!1;case 16:e.next=21;break;case 18:e.prev=18,e.t0=e.catch(0),console.log(e.t0.response.data);case 21:case"end":return e.stop()}}),e,null,[[0,18]])})))()}}},d=r(23),component=Object(d.a)(o,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"row py-5"},[t.$store.getters["auth/username"]?r("div",{staticClass:"col-12"},[r("card-layout",{attrs:{title:t.user.username}},[r("div",{staticClass:"card-body text-primary text-left"},[t.$store.state.auth.user.confirmed?t._e():r("div",[r("h4",[t._v("Account not confirmed, check your email to confirm account. ")]),t._v(" "),r("p",[t._v("If it does not show up check the spam folder. If after 24 hours you still have not received the confirmation email contact\n\t\t\t\t\t\t"),r("a",{staticClass:"text-white",attrs:{href:"mailto:support@poe.house"}},[t._v("support@poe.house")]),t._v(" with your registered email.\n\t\t\t\t\t")])]),t._v(" "),t.$store.state.auth.user.confirmed?r("div",[t.userHideouts.length<=0||!t.userHideouts?r("div",{staticClass:"text-center"},[t.claimable?r("a",{staticClass:"btn btn-primary",attrs:{href:"#"},on:{click:function(e){return e.preventDefault(),t.claimEmailHideouts()}}},[r("h4",[t._v("Claim email hideouts")])]):t._e(),t._v(" "),t.claimable?t._e():r("h4",[t._v("You have no hideouts yet. If you want to claim a hideout send an email to\n\t\t\t\t\t\t\t"),r("a",{staticClass:"text-white",attrs:{href:"mailto:support@poe.house"}},[t._v("support@poe.house")]),t._v(" with a link to the hideout and your account name.\n\t\t\t\t\t\t")])]):t._e(),t._v(" "),t._l(t.userHideouts,(function(e,n){return r("div",{key:n,staticClass:"col-xs-12 my-2"},[r("div",{staticClass:"media border-bottom border-dark"},[r("div",{staticClass:"row w-100"},[r("img",{staticClass:"align-self-center mr-3 xs-12 lg-2",attrs:{src:t.$getThumbnail(t.getImage(e))}}),t._v(" "),r("div",{staticClass:"media-body py-3  xs-12 lg-10"},[r("div",{staticClass:"card-title text-white "},[r("h4",[t._v(t._s(e.nameDescription))]),t._v(" "),r("small",{staticClass:"text-primary"},[t._v(t._s(e.views)+" "),r("i",{staticClass:"fas fa-eye pr-2"}),t._v(" "+t._s(e.downloads)+" "),r("i",{staticClass:"fas fa-file-download pr-2"}),t._v(" "+t._s(e.comments.length)+" "),r("i",{staticClass:"fas fa-comments"})])]),t._v(" "),r("div",{staticClass:"row"},[r("div",{staticClass:"col-12"},[r("table",{staticClass:"table table-sm table-striped table-dark bg-secondary text-primary "},[r("tbody",[r("tr",[r("th",{attrs:{scope:"row"}},[t._v("Hideout")]),t._v(" "),r("td",{staticClass:"text-white"},[r("strong",[t._v(t._s(t.getHideout(e.hideoutType)))])])]),t._v(" "),e.views?r("tr",[r("th",{attrs:{scope:"row"}},[t._v("Views")]),t._v(" "),r("td",{staticClass:"text-white"},[r("strong",[t._v(t._s(e.views))])])]):t._e(),t._v(" "),e.downloads?r("tr",[r("th",{attrs:{scope:"row"}},[t._v("Downloads")]),t._v(" "),r("td",{staticClass:"text-white"},[r("strong",[t._v(t._s(e.downloads))])])]):t._e(),t._v(" "),r("tr",[r("th",{attrs:{scope:"row"}},[t._v("Posted")]),t._v(" "),r("td",{staticClass:"text-white"},[r("strong",[t._v(t._s(t.$moment.unix(e.hideoutDateSubmit.seconds).format(" MMMM Do YYYY")))])])])])])])]),t._v(" "),r("div",{staticClass:"row justify-content-between"},[r("div",{staticClass:"col-3"},[e.hideoutMasters.mtx?r("img",{attrs:{src:"https://web.poecdn.com/image/shop/item/ShopItemCoin.png?1538109960000",alt:""}}):t._e(),t._v(" "),e.hideoutMasters.mtx?r("small",[t._v("MTX")]):t._e()]),t._v(" "),r("div",{staticClass:"col-3 text-right"},[r("nuxt-link",{staticClass:"btn btn-primary mt-3",attrs:{to:"/hideout/"+e.hideoutId+"/edit"}},[t._v("Edit")]),t._v(" "),r("a",{staticClass:"btn btn-danger text-white mt-3",attrs:{"data-target":"#exampleModal-"+e.hideoutId,hrf:"#","data-toggle":"modal"}},[t._v("Delete")]),t._v(" "),r("div",{staticClass:"modal fade",attrs:{id:"exampleModal-"+e.hideoutId,tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true"}},[r("div",{staticClass:"modal-dialog bg-dark",attrs:{role:"document"}},[r("div",{staticClass:"modal-content  bg-secondary"},[r("div",{staticClass:"modal-header"},[r("h5",{staticClass:"modal-title",attrs:{id:"exampleModalLabel"}},[t._v("Deletion Confirmation")]),t._v(" "),r("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal","aria-label":"Close"}},[r("span",{attrs:{"aria-hidden":"true"}},[t._v("Ã—")])])]),t._v(" "),r("div",{staticClass:"modal-body text-left"},[t._v("\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tAre you sure you want to delete this hideout ? It will be lost for ever!\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t")]),t._v(" "),r("div",{staticClass:"modal-footer"},[r("button",{staticClass:"btn btn-success",attrs:{type:"button","data-dismiss":"modal"},on:{click:function(e){return e.preventDefault(),t.deleteHideout(t.userHideouts[n].hideoutId)}}},[t._v("Confirm")]),t._v(" "),r("button",{staticClass:"btn btn-danger",attrs:{type:"button"}},[t._v("Cancel")])])])])])],1)])])])])])}))],2):t._e()])])],1):t._e()])}),[],!1,null,null,null);e.default=component.exports}}]);