{"version":3,"file":"pages/user/index.js","sources":["webpack:///./pages/user/index.vue?def9","webpack:///./pages/user/index.vue","webpack:///./pages/user/index.vue?7bd9","webpack:///./pages/user/index.vue?52d6"],"sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"row py-5\"},[(_vm.$store.getters['auth/username'])?_vm._ssrNode(\"<div class=\\\"col-12\\\">\",\"</div>\",[_c('card-layout',{attrs:{\"title\":_vm.user.username}},[_c('div',{staticClass:\"card-body text-primary text-left\"},[(!_vm.$store.state.auth.user.confirmed)?_c('div',[_c('h4',[_vm._v(\"Account not confirmed, check your email to confirm account. \")]),_vm._v(\" \"),_c('p',[_vm._v(\"If it does not show up check the spam folder. If after 24 hours you still have not received the confirmation email contact\\n\\t\\t\\t\\t\\t\\t\"),_c('a',{staticClass:\"text-white\",attrs:{\"href\":\"mailto:support@poe.house\"}},[_vm._v(\"support@poe.house\")]),_vm._v(\" with your registered email.\\n\\t\\t\\t\\t\\t\")])]):_vm._e(),_vm._v(\" \"),(_vm.$store.state.auth.user.confirmed)?_c('div',[(_vm.userHideouts.length <= 0 || !_vm.userHideouts)?_c('div',{staticClass:\"text-center\"},[(_vm.claimable)?_c('a',{staticClass:\"btn btn-primary\",attrs:{\"href\":\"#\"},on:{\"click\":function($event){$event.preventDefault();return _vm.claimEmailHideouts()}}},[_c('h4',[_vm._v(\"Claim email hideouts\")])]):_vm._e(),_vm._v(\" \"),(!_vm.claimable)?_c('h4',[_vm._v(\"You have no hideouts yet. If you want to claim a hideout send an email to\\n\\t\\t\\t\\t\\t\\t\\t\"),_c('a',{staticClass:\"text-white\",attrs:{\"href\":\"mailto:support@poe.house\"}},[_vm._v(\"support@poe.house\")]),_vm._v(\" with a link to the hideout and your account name.\\n\\t\\t\\t\\t\\t\\t\")]):_vm._e()]):_vm._e(),_vm._v(\" \"),_vm._l((_vm.userHideouts),function(hideout,index){return _c('div',{key:index,staticClass:\"col-xs-12 my-2\"},[_c('div',{staticClass:\"media border-bottom border-dark\"},[_c('div',{staticClass:\"row w-100\"},[_c('img',{staticClass:\"align-self-center mr-3 xs-12 lg-2\",attrs:{\"src\":_vm.$getThumbnail(_vm.getImage(hideout))}}),_vm._v(\" \"),_c('div',{staticClass:\"media-body py-3  xs-12 lg-10\"},[_c('div',{staticClass:\"card-title text-white \"},[_c('h4',[_vm._v(_vm._s(hideout.nameDescription))]),_vm._v(\" \"),_c('small',{staticClass:\"text-primary\"},[_vm._v(_vm._s(hideout.views)+\" \"),_c('i',{staticClass:\"fas fa-eye pr-2\"}),_vm._v(\" \"+_vm._s(hideout.downloads)+\" \"),_c('i',{staticClass:\"fas fa-file-download pr-2\"}),_vm._v(\" \"+_vm._s(hideout.comments.length)+\" \"),_c('i',{staticClass:\"fas fa-comments\"})])]),_vm._v(\" \"),_c('div',{staticClass:\"row\"},[_c('div',{staticClass:\"col-12\"},[_c('table',{staticClass:\"table table-sm table-striped table-dark bg-secondary text-primary \"},[_c('tbody',[_c('tr',[_c('th',{attrs:{\"scope\":\"row\"}},[_vm._v(\"Hideout\")]),_vm._v(\" \"),_c('td',{staticClass:\"text-white\"},[_c('strong',[_vm._v(_vm._s(_vm.getHideout(hideout.hideoutType)))])])]),_vm._v(\" \"),(hideout.views)?_c('tr',[_c('th',{attrs:{\"scope\":\"row\"}},[_vm._v(\"Views\")]),_vm._v(\" \"),_c('td',{staticClass:\"text-white\"},[_c('strong',[_vm._v(_vm._s(hideout.views))])])]):_vm._e(),_vm._v(\" \"),(hideout.downloads)?_c('tr',[_c('th',{attrs:{\"scope\":\"row\"}},[_vm._v(\"Downloads\")]),_vm._v(\" \"),_c('td',{staticClass:\"text-white\"},[_c('strong',[_vm._v(_vm._s(hideout.downloads))])])]):_vm._e(),_vm._v(\" \"),_c('tr',[_c('th',{attrs:{\"scope\":\"row\"}},[_vm._v(\"Posted\")]),_vm._v(\" \"),_c('td',{staticClass:\"text-white\"},[_c('strong',[_vm._v(_vm._s(_vm.$moment.unix(hideout.hideoutDateSubmit.seconds).format(' MMMM Do YYYY')))])])])])])])]),_vm._v(\" \"),_c('div',{staticClass:\"row justify-content-between\"},[_c('div',{staticClass:\"col-3\"},[(hideout.hideoutMasters['mtx'])?_c('img',{attrs:{\"src\":\"https://web.poecdn.com/image/shop/item/ShopItemCoin.png?1538109960000\",\"alt\":\"\"}}):_vm._e(),_vm._v(\" \"),(hideout.hideoutMasters['mtx'])?_c('small',[_vm._v(\"MTX\")]):_vm._e()]),_vm._v(\" \"),_c('div',{staticClass:\"col-3 text-right\"},[_c('nuxt-link',{staticClass:\"btn btn-primary mt-3\",attrs:{\"to\":(\"/hideout/\" + (hideout.hideoutId) + \"/edit\")}},[_vm._v(\"Edit\")]),_vm._v(\" \"),_c('a',{staticClass:\"btn btn-danger text-white mt-3\",attrs:{\"data-target\":(\"#exampleModal-\" + (hideout.hideoutId)),\"hrf\":\"#\",\"data-toggle\":\"modal\"}},[_vm._v(\"Delete\")]),_vm._v(\" \"),_c('div',{staticClass:\"modal fade\",attrs:{\"id\":(\"exampleModal-\" + (hideout.hideoutId)),\"tabindex\":\"-1\",\"role\":\"dialog\",\"aria-labelledby\":\"exampleModalLabel\",\"aria-hidden\":\"true\"}},[_c('div',{staticClass:\"modal-dialog bg-dark\",attrs:{\"role\":\"document\"}},[_c('div',{staticClass:\"modal-content  bg-secondary\"},[_c('div',{staticClass:\"modal-header\"},[_c('h5',{staticClass:\"modal-title\",attrs:{\"id\":\"exampleModalLabel\"}},[_vm._v(\"Deletion Confirmation\")]),_vm._v(\" \"),_c('button',{staticClass:\"close\",attrs:{\"type\":\"button\",\"data-dismiss\":\"modal\",\"aria-label\":\"Close\"}},[_c('span',{attrs:{\"aria-hidden\":\"true\"}},[_vm._v(\"Ã—\")])])]),_vm._v(\" \"),_c('div',{staticClass:\"modal-body text-left\"},[_vm._v(\"\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\tAre you sure you want to delete this hideout ? It will be lost for ever!\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\")]),_vm._v(\" \"),_c('div',{staticClass:\"modal-footer\"},[_c('button',{staticClass:\"btn btn-success\",attrs:{\"type\":\"button\",\"data-dismiss\":\"modal\"},on:{\"click\":function($event){$event.preventDefault();return _vm.deleteHideout(_vm.userHideouts[index].hideoutId)}}},[_vm._v(\"Confirm\")]),_vm._v(\" \"),_c('button',{staticClass:\"btn btn-danger\",attrs:{\"type\":\"button\"}},[_vm._v(\"Cancel\")])])])])])],1)])])])])])})],2):_vm._e()])])],1):_vm._e()])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\r\nimport CardLayout from '~/components/CardLayout.vue';\r\n\r\nexport default {\r\n\tmiddleware: 'auth',\r\n\tcomponents: {\r\n\t\tCardLayout\r\n\t},\r\n\tdata () {\r\n\t\treturn {\r\n\t\t\tuser: {},\r\n\t\t\tclaimable: true\r\n\t\t};\r\n\t},\r\n\tcomputed: {\r\n\t\t// user () {\r\n\t\t// \treturn this.$store.state.auth.user;\r\n\t\t// },\r\n\t\tuserHideouts () {\r\n\t\t\treturn (this.user.hideouts) ? this.user.hideouts : [];\r\n\t\t}\r\n\t},\r\n\tasync created () {\r\n\t\tawait this.getUserHideouts();\r\n\t},\r\n\tmethods: {\r\n\t\tgetImage (hideout) {\r\n\t\t\tif (/.jpg|.png|jpeg/gi.test(hideout.hideoutScreenshot)) {\r\n\t\t\t\treturn hideout.hideoutScreenshot;\r\n\t\t\t} else {\r\n\t\t\t\treturn this.$store.getters.getHideout(hideout.hideoutType)['Icon'];\r\n\t\t\t}\r\n\t\t},\r\n\t\tasync deleteHideout (id) {\r\n\t\t\ttry {\r\n\t\t\t\tconst hideout = await this.$axios.$get(`/api/hideouts?hideoutId=${id}`);\r\n\t\t\t\thideout[0].isDeleted = true;\r\n\t\t\t\tawait this.$axios.put(`/api/hideouts/${hideout[0].id}`, hideout[0]);\r\n\t\t\t\tawait this.$store.dispatch('auth/updateUserHideouts');\r\n\t\t\t\tawait this.getUserHideouts();\r\n\t\t\t} catch (e) {\r\n\t\t\t\tconsole.log(e);\r\n\t\t\t}\r\n\t\t},\r\n\t\tgetHideout (hash) {\r\n\t\t\treturn this.$store.getters.getHideout(hash)['Name'];\r\n\t\t},\r\n\t\tasync getUserHideouts () {\r\n\t\t\tlet query = '';\r\n\t\t\tif (this.$store.state.auth.user) {\r\n\t\t\t\tquery = `\r\n                query{\r\n                    user(id:\"${this.$store.state.auth.user._id}\"){\r\n                            username\r\n                            confirmed\r\n                            hideouts(where:{\r\n                                isDeleted_ne:true\r\n                            }){\r\n                                hideoutId\r\n                                nameDescription\r\n                                hideoutType\r\n                                views\r\n                                downloads\r\n                                comments{\r\n                                    _id\r\n                                }\r\n                                hideoutDateSubmit\r\n                                hideoutMasters\r\n                                hideoutScreenshot\r\n                                votes{\r\n                                    score\r\n                                }\r\n                            }\r\n                            }\r\n                        }\r\n                `;\r\n\t\t\t}\r\n\t\t\ttry {\r\n\t\t\t\tconst { data } = await this.$axios.$post(`/api/graphql`, { query });\r\n\t\t\t\tthis.user = data.user;\r\n\t\t\t} catch (e) {\r\n\t\t\t\tconsole.log(e);\r\n\t\t\t}\r\n\t\t},\r\n\t\tasync claimEmailHideouts () {\r\n\t\t\ttry {\r\n\t\t\t\tconst getHideoutsQuery = `\r\n                        query{\r\n                            hideouts(where:{\r\n                                authorEmail:\"${this.$store.state.auth.user.email}\",\r\n                                isDeleted_ne:true\r\n                            }){\r\n                                _id\r\n                            }\r\n                            }\r\n                        `;\r\n\t\t\t\tconst { data } = await this.$axios.$post(`/api/graphql`, { query: getHideoutsQuery });\r\n\t\t\t\tlet ids = '';\r\n\t\t\t\tif (data.hideouts.length > 0) {\r\n\t\t\t\t\tdata.hideouts.forEach(hide => { ids += `, \"${hide._id}\"`; });\r\n\t\t\t\t\tconst updateQuery = `\r\n                                mutation{\r\n                                    updateHideout(input:{\r\n                                        where:{\r\n                                            id:${ids.replace(', \"', '\"')}\r\n                                        },\r\n                                        data:{\r\n                                            user:\"${this.$store.state.auth.user._id}\"\r\n                                        }\r\n                                    }){\r\n                                        hideout{\r\n                                            user{\r\n                                                username,\r\n                                                email\r\n                                            }\r\n                                        }\r\n                                    }\r\n                                }\r\n                    `;\r\n\t\t\t\t\tawait this.$axios.post(`/api/graphql`, { query: updateQuery });\r\n\t\t\t\t\tthis.$store.dispatch('auth/updateUserHideouts');\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.claimable = false;\r\n\t\t\t\t}\r\n\t\t\t} catch (e) {\r\n\t\t\t\tconsole.log(e.response.data);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n};\r\n","import mod from \"-!../../node_modules/babel-loader/lib/index.js??ref--2-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/babel-loader/lib/index.js??ref--2-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./index.vue?vue&type=template&id=3aa0183b&\"\nimport script from \"./index.vue?vue&type=script&lang=js&\"\nexport * from \"./index.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  \"46afef01\"\n  \n)\n\nexport default component.exports"],"mappings":";;;;;;;;;;;AAAA;AACA;AACA;;;;;;;;ACFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AAEA;AACA;AACA;AACA;AADA;AACA;AAEA;AACA;AACA;AACA;AAFA;AAIA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAPA;AACA;AAOA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AAAA;AACA;;AAEA;;;;;;;;;;;;;;;;;;;;;;;AAFA;AA0BA;AACA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;;;AAGA;;;;;;AAHA;AAUA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AAAA;AACA;AAAA;AAAA;AACA;;;;AAIA;;;AAGA;;;;;;;;;;;AAPA;AAmBA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAvGA;AAtBA;;ACvJA;;;;;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;A","sourceRoot":""}